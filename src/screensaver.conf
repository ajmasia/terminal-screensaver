#!/bin/bash
# Screensaver configuration loader
# Sources user config and provides defaults

CONFIG_FILE="$HOME/.config/terminal-screensaver/screensaver.conf"
SCREENSAVER_DIR="$HOME/.local/share/terminal-screensaver"
LOG_DIR="${XDG_STATE_HOME:-$HOME/.local/state}/terminal-screensaver"
LOG_FILE="$LOG_DIR/screensaver.log"

# Ensure log directory exists
mkdir -p "$LOG_DIR"

# Logging function
log() {
    echo "[$(date '+%Y-%m-%d %H:%M:%S')] $*" >> "$LOG_FILE"
}

# Default values
TERMINAL_SCREENSAVER_ASCII_FILE="${TERMINAL_SCREENSAVER_ASCII_FILE:-$HOME/.config/terminal-screensaver/banner.txt}"
TERMINAL_SCREENSAVER_IDLE_TIMEOUT="${TERMINAL_SCREENSAVER_IDLE_TIMEOUT:-120}"
TERMINAL_SCREENSAVER_FRAME_RATE="${TERMINAL_SCREENSAVER_FRAME_RATE:-60}"

# Load user config if exists
if [[ -f "$CONFIG_FILE" ]]; then
    # shellcheck source=/dev/null
    source "$CONFIG_FILE"
fi

# Export all config variables
export TERMINAL_SCREENSAVER_ASCII_FILE
export TERMINAL_SCREENSAVER_IDLE_TIMEOUT
export TERMINAL_SCREENSAVER_FRAME_RATE
